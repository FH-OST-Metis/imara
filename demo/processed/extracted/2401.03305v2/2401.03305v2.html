<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>2401.03305v2</title>
<meta name="generator" content="Docling HTML Serializer"/>
<style>
    html {
        background-color: #f5f5f5;
        font-family: Arial, sans-serif;
        line-height: 1.6;
    }
    body {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        background-color: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3, h4, h5, h6 {
        color: #333;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    h1 {
        font-size: 2em;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.3em;
    }
    table {
        border-collapse: collapse;
        margin: 1em 0;
        width: 100%;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
    figure {
        margin: 1.5em 0;
        text-align: center;
    }
    figcaption {
        color: #666;
        font-style: italic;
        margin-top: 0.5em;
    }
    img {
        max-width: 100%;
        height: auto;
    }
    pre {
        background-color: #f6f8fa;
        border-radius: 3px;
        padding: 1em;
        overflow: auto;
    }
    code {
        font-family: monospace;
        background-color: #f6f8fa;
        padding: 0.2em 0.4em;
        border-radius: 3px;
    }
    pre code {
        background-color: transparent;
        padding: 0;
    }
    .formula {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background-color: #f9f9f9;
    }
    .formula-not-decoded {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background: repeating-linear-gradient(
            45deg,
            #f0f0f0,
            #f0f0f0 10px,
            #f9f9f9 10px,
            #f9f9f9 20px
        );
    }
    .page-break {
        page-break-after: always;
        border-top: 1px dashed #ccc;
        margin: 2em 0;
    }
    .key-value-region {
        background-color: #f9f9f9;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .key-value-region dt {
        font-weight: bold;
    }
    .key-value-region dd {
        margin-left: 1em;
        margin-bottom: 0.5em;
    }
    .form-container {
        border: 1px solid #ddd;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .form-item {
        margin-bottom: 0.5em;
    }
    .image-classification {
        font-size: 0.9em;
        color: #666;
        margin-top: 0.5em;
    }
</style>
</head>
<body>
<div class='page'>
<p>1</p>
<h2>Leveraging IS and TC: Optimal order execution subject to reference strategies</h2>
<p>Xue Cheng 1 , Peng Guo 1 , and Tai-Ho Wang 2</p>
<p>LMEQF, Department of Financial Mathematics, School of Mathematical Sciences, Peking University, Beijing 100871, China. 2</p>
<p>Department of Mathematics, Baruch College, CUNY, 1 Bernard Baruch Way, New York, NY 10010, USA</p>
<p>March 5, 2025</p>
<h2>Abstract</h2>
<p>The paper addresses the problem of meta order execution from a broker-dealer's point of view in Almgren-Chriss model under execution risk. A broker-dealer agency is authorized to execute an order of trading on some client's behalf. The strategies that the agent is allowed to deploy is subject to a benchmark, referred to as the reference strategy, regulated by the client. We formulate the broker's problem as a utility maximization problem in which the broker seeks to maximize his utility of excess profit-and-loss at the execution horizon, of which optimal feedback strategies are obtained in closed form. In the absence of execution risk, the optimal strategies subject to reference strategies are deterministic. We establish an affine structure among the trading trajectories under optimal strategies subject to general reference strategies using implementation shortfall (IS) and target close (TC) orders as basis. Furthermore, an approximation theorem is proposed to show that with small error, general reference strategies can be approximated by piece-wise constant ones, of which the optimal strategy is piece-wise linear combination between IS and TC orders. We conclude the paper with numerical experiments illustrating the trading trajectories as well as histograms of terminal wealth and utility at investment horizon under optimal strategies versus those under TWAP strategies.</p>
<p>Keywords: Optimal execution; Price impact; Execution risk; Utility maximization; Reference strategy; Affine structure; Implementation shortfall order; Target close order</p>
<h2>Contents</h2>
<table><tbody><tr><td>1</td><td>Introduction</td><td>3</td></tr><tr><td>2</td><td>Model setup</td><td>5</td></tr><tr><td>2.1</td><td>Price impact model . . . . . . . . . . . .</td><td>5</td></tr><tr><td>2.2</td><td>Reference strategy . . . . . . . . . . . .</td><td>6</td></tr><tr><td>3</td><td>Optimal execution as utility maximizing</td><td>7</td></tr><tr><td>3.1</td><td>Optimal execution with risk aversion . .</td><td>7</td></tr></tbody></table>
<table><tbody><tr><td colspan="3">4 Zero execution risk</td><td>10</td></tr><tr><td></td><td>4.1</td><td>General reference strategy . . . . . . . . . . . . . . . . . . . . .</td><td>11</td></tr><tr><td></td><td>4.2</td><td>Implementation shortfall (IS) order and target close (TC) order</td><td>12</td></tr><tr><td></td><td>4.3</td><td>Endpoints-only reference strategy . . . . . . . . . . . . . . . . .</td><td>14</td></tr><tr><td></td><td>4.4</td><td>Piece-wise constant reference strategy . . . . . . . . . . . . . .</td><td>16</td></tr><tr><td>5</td><td colspan="2">Numerical examples</td><td>18</td></tr><tr><td></td><td>5.1</td><td>Sample trading trajectories . . . . . . . . . . . . . . . . . . . .</td><td>18</td></tr><tr><td></td><td>5.2</td><td>Performance analysis and stress test . . . . . . . . . . . . . . .</td><td>22</td></tr><tr><td>6</td><td colspan="2">Conclusion</td><td>25</td></tr><tr><td>A</td><td colspan="2">Appendix</td><td>25</td></tr></tbody></table>
<h2>1 Introduction</h2>
<p>In the financial industry, large position holders such as pension funds or investment banks for various reasons are required to trade in or trade out from their current position to an updated target, possibly subject to a given execution horizon which may vary from days to weeks. The net holdings to be adjusted between the current and the target positions are usually too large to be simply dumped to the market without a priori deliberately assessing the trade's market impact. Untamed price impact by trading may result in significant transaction cost, potentially turned into a substantial loss. Such an execution risk requires to be properly managed and controlled; otherwise it would eventually influence the position holder's overall profit and loss (P&amp;L). A common practice is to delegate the execution to the firm's order execution department or outsource to a broker-dealer agency.</p>
<p>The large position holders, while delegating their tasks to an agency for execution, may have in mind their own preferred strategies or benchmarks that they would like the delegated agent to closely track along. For instance, implementation shortfall (IS) orders [1] are frequently employed by managers for the purpose of short-term alpha pursuit. IS orders are constructed with a pre-trade benchmark price in mind, aiming at executing orders at an average price that remains relatively close to the market price at the beginning of the trade. Managers can often use arrival prices to help measure total trading costs: the closer the execution price is to the arrival price, the lower the associated costs (see CFA-level-II [2]). On the contrary, target close (TC) orders [3], often deployed by index-fund managers for the purpose of minimizing fund risk and tracking error, are formulated with a post-trade benchmark price in order to secure a price in average that remains relatively close to the closing price. This is often important for mutual fund managers who manage funds that only calculate NAV once daily at closing. Volume weighted average price (VWAP) and Time weighted average price (TWAP) strategies are benchmarks specified for trading sequences with constant trading rate in wall clock time (TWAP) and in volume time (VWAP) respectively. These algorithmic trading strategies are examples of benchmarks that may be imposed as trading constraints to the agent who is missioned to trade in or trade out the position. We shall delve into this type of order execution problems subject to a pre-specified benchmark strategy, which we refer to as the reference strategy (RS for short), as a stochastic control problem and determine their corresponding optimal strategies in feedback form.</p>
<p>The pioneering works in [4], [1], [5] and [6] are among the first to deal with the problem of order execution under price impact. Since its introduction to the order execution problem, numerous progresses and extensions on the classical Almgren-Chriss framework have been made extensively. For instance, [7] and [8] introduced the notion of transient impact to account for the dissipation of price impacts from the past trades. [9] discusses the objective in the optimization problem, while [10] extends the classical mean-variance framework first considered in [4] to encompass general risk measures as penalty for risk aversion. [11], [12], [13] solve the optimal execution problem in relation to a VWAP benchmark, while [14] asserts the use of the arrival price as a benchmark within the Almgren-Chriss framework. In fact, the arrival price, also known as 'pre-trade benchmark', appears to be the most commonly used benchmark in academic papers. The closing price is the value of a security at its last transaction during a trading session [3] [15]. Average price benchmarks may also appear in accelerated share repurchase (ASR) contracts [16][17], which can be regarded as optimal execution problems with optimal stopping. Above all, [18] introduces the concept of execution risk, that</p>
<p>pre-scheduled orders may not be fully executed, of which the empirical evidence is confirmed by [19] that the inventory processes of traders invariably contain a Brownian motion term, which contradicts the common assumption adopted in most optimal execution models that the inventory process is absolute continuous. Another perspective on introducing the noise term into the inventory process is that when a centralized trading desk aggregates order flows within a financial institution, stochastic order flow arises [20] [21]. The aforementioned papers are by no means meant for an exhausting list in literature on this line of active research.</p>
<p>In the current paper, we consider the order execution problem from a broker-dealer's point of view. Assume that a broker is delegated to reallocate a client's holdings of a certain stock under the Almgren-Chriss model with execution risk. The broker is regulated by his client to track a benchmark strategy, i.e., the reference strategy, to the client's preference. The broker's incentive of executing client's order in this circumstance is to maximize his own expected P&amp;L excess to that of the reference strategy, marked-to-market. To account for risk aversion, we recast the broker's order execution problem as a utility maximization problem and, in certain cases, are able to solve the problem in closed form. In particular, when execution risk vanishes, or becomes negligible, we show that there exists an 'affine structure' among the optimal strategies induced from various reference strategies. This algebraic structure is supposed to help the broker for concocting and understanding optimal strategies subject to client's general reference strategies. We argue that the framework is highly versatile in the sense that it encompasses commonly deployed execution strategies such as IS, TC as well as TWAP and VWAP orders as special cases for benchmarking. As per the algebraic structure, it follows that, for any given continuous reference strategy which can be approximated by a piece-wise constant function, we show that its corresponding optimal strategy can also be approximated by those induced from the piece-wise constant strategies.</p>
<p>The rest of the paper is organized as follows. In Section 2, we lay out the price impact model of AlmgrenChriss under execution risk and incorporate reference strategies into the problem of order execution. Section 3 presents the optimal feedback control of the order execution problem in Theorem 1 as one of the main results in the paper. Section 4 focuses and provides detailed discussions on the optimal strategies when execution risk vanishes. Reference strategies and their associated optimal strategies considered in Section 4 include IS and TC orders as well as piece-wise constant strategies. The emphasis is put on an 'affine structure' among the trading trajectories induced by general reference strategies using unit IS and unit TC orders as a basis. Numerical examples illustrating the trading trajectories and the performance analysis under the optimal and TWAP strategies are shown and discussed in Section 5. For the sake of smooth reading, technical proofs of all the theorems, propositions and lemmas are postponed and collected till the end of the paper as an appendix in Section A.</p>
<p>Throughout the paper, (Ω , F , P ) denotes a complete probability space equipped with a filtration describing the information structure F := {F t } t ∈ [0 ,T ] , where t is the time variable and T &gt; 0 the fixed finite liquidation horizon. Let { W t , Z t } t ∈ [0 ,T ] be a two-dimensional Brownian motion with constant correlation ρ defined on (Ω , F , P ) . The filtration F is generated by the trajectories of the above Brownian motion, completed with all P -null measure sets of F .</p>
<h2>2 Model setup</h2>
<h2>2.1 Price impact model</h2>
<p>Assume a broker is delegated to reallocate a client's holdings of a certain stock from x 0 shares to A shares within a given horizon T . Let x t be the number of shares the broker holds at time t ∈ [0 , T ] during the reallocation process and ˜ S t the transacted price at time t . The price dynamic is assumed to follow the Almgren-Chriss model [4] [1] [5]. In the Almgren-Chriss framework, the transacted price ˜ S t consists of the fair price S t and a slippage. The fair price S t is driven by the SDE</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where µt describes the tendency of the stock and ( W t ) t ∈ [0 ,T ] is a standard Brownian motion. The term γ ( x t -x 0 ) , for γ ≥ 0 , is usually referred to as the permanent impact . Penalized by a price slippage, the transacted price is thus given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where v t denotes the broker's intended trading rate at the instant t . The slippage -ηv t , for η ≥ 0 , is also referred to as the temporary impact . We remark that in the original setting of Almgren-Chriss and its extensions, the trading rate v t plays a dual role. On the one hand, it serves as the realized trading rate per the relationship v t = -˙ x t between x t and v t . On the other hand, it is regarded as the control variable in the problem of optimal execution. These two seemingly distinct roles coincide if all the scheduled orders are guaranteed fully executed. However, in reality it is well noticed among practitioners that, while executing a sequence of pre-scheduled orders, the orders in the sequence may not be fully executed, resulting in an uncontrollable realized order flow. This introduces an additional risk to the order execution problem, the execution risk . To account for this uncertainty, we introduce a noise component driven by a correlated Brownian motion Z t into the dynamic of the position x t as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The diffusion term m ( v ) characterizes the magnitude of execution risk. It is worth to reiterate that in a recent work in [19], the authors showed that the presence of a Brownian component in the broker's inventory during reallocation process is statistically significant. Moreover, because of this execution risk, the broker is no longer guaranteed to achieve his intended position at the terminal time T , which gives rise to an additional opportunity cost. As a result, the broker is obligated to take a final block trade at time T at a worse price. Overall, the realised P&amp;L at the horizon T is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>or equivalently,</p>
<p>where the term β ( x T -A ) 2 , for β ≥ 0 , penalizes the discrepency from a final block trade.</p>
<p>The following proposition shows that the P&amp;L can be written as an Itô process.</p>
<p>Proposition 1. The realised P&amp;L can be rewritten as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>2.2 Reference strategy</h2>
<p>A common practice in order execution brokerage is that clients may come forward to brokers with their own preferred strategies for benchmarking. These benchmark strategies can be either strategies suggested by elite investors or commonly used ones such as TWAP strategies. We shall refer to these pre-specified benchmark strategies as reference strategies . We consider the reference strategies that can be represented by a deterministic function ( R t ) t ∈ [0 ,T ] with R 0 ≡ x 0 and R T ≡ A hereafter. Moreover, we assume that R t is a differentiable a.e. function. The broker's incentive of executing client's order is thus to maximize his own expected P&amp;L excess to that of the reference strategy, marked-to-market. Specifically, by disregarding the price impact and slippages incurred from order execution, the stock price S 0 t reads</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The marked-to-market P&amp;L Π R for the reference strategy R is evaluated as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Hence, the broker's excess P&amp;L ˜ Π , defined by the difference between Π and Π R , is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The broker's goal is thus to maximize his expected excess P&amp;L in a risk aversion manner which we recast as a utility maximization problem in the section that follows.</p>
<h2>3 Optimal execution as utility maximizing</h2>
<p>In this section, we recast the problem of order execution as a utility maximization problem as follows. Recall that (Ω , F , P ) denotes a complete probability space equipped with a filtration ( F t ) t ≥ 0 satisfying the usual conditions. We assume that all random variables and stochastic processes are defined on (Ω , F , ( F t ) t ≥ 0 , P ) . The set of all real-valued progressively measurable processes are denote by M , while the collection of admissible controls A is set as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>to meet the assumptions given in [22] and [23], which assure the solvability of both the risk-neutral problem and the risk-aversion one. The broker's problem is to determine an optimal admissible strategy v ∗ that maximizes his expected exponential utility at the horizon T , i.e.,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where the utility function u ( x ) := 1 θ (1 -e -θx ) , θ &gt; 0 represents the broker's preference following CARA (Constant Absolute Risk Aversion) preference and θ &gt; 0 is the risk-aversion parameter. Note that as θ ↓ 0 , the utility function u ( x ) = lim θ ↓ 0 1 θ (1 -e -θx ) = x reflects a risk-neutral preference. When the utility function is selected as u ( x ) = x , we solve the stochastic control problem and give the close form of the value function E [ ˜ Π ] ∣ ∣ ∣ ∣ v = v ∗∗ = sup v ∈A E [ ˜ Π ] &lt; ∞ , where v ∗∗ ∈ A is the optimal feedback control in the risk-neutral case, see in Appendix A.2. Moreover, when u ( x ) = 1 θ (1 -e -θx ) , u ′ ( x ) = e -θx &gt; 0 , u ′′ ( x ) = -θe -θx &lt; 0 , so u ( · ) is a increasing concave function. For any admissible control ˜ v , by Jensen's inequality,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which shows the finiteness of the utility maximizing problem. In the following, we solve the utility maximization problem (2) and present solutions in closed form in the cases where the execution risk m ( v ) is either a constant or zero. The case of zero execution risk is postponed and will be discussed in more details in Section 4.</p>
<h2>3.1 Optimal execution with risk aversion</h2>
<p>When the execution risk is constant, i.e., m ( v ) ≡ m 0 for some fixed constant m 0 , the utility maximizing problem reduces to the following Stochastic Linear Exponential Quadratic (SLEQ) control problem [23] [24]</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Define the value function of the problem by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where A t := { v is progressively measurable in [ t, T ] and ∫ T t E [ v 2 s ]d s &lt; ∞ } . The optimal feedback control can be obtained in closed form. We summarize the result in the following theorem.</p>
<p>Theorem 1. The value function (4) of the utility maximization problem has the closed form expression</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where the parameters H , l 1 , and l 3 are given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The time dependent function b 2 is given in closed form by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>b 1 is the solution to the following terminal value problem</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>and</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Moreover, the optimal feedback control v ∗ ∈ A of the utility maximization problem (2) is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>It's worth mentioning that this theorem does not contain much mathematical breakthrough, instead, we regard it as a fundamental result to introduce valuable results in section 4, where the affine structure is what we find the most interesting.</p>
<p>Remark 1. The optimal feedback control v ∗ t in (5) consists of three parts:</p>
<ul>
<li style="list-style-type: '· ';">The first part (1+ θηm 2 0 ) b 2 H · ( x t -A ) has the same sign as x t -A . Without loss of generality, we assume that x 0 &gt; A , when x t ≥ A , which implies the reallocation process has not finished, so the broker should</li>
</ul>
<p>continue to sell the stock. Conversely, when x t &lt; A , which implies the strategy is over-shooting, so the broker should buy some shares of the stock back.</p>
<ul>
<li style="list-style-type: '· ';">The second part 1+ θηm 2 0 2 H · b 1 , which is a pre-specified deterministic function in time t , does not depend on the state variable x t .</li>
<li style="list-style-type: '· ';">The third part l 3 H · ( R t -x t ) has the same sign as ρ ( R t -x t ) , where ρ is the correlation between the stock price process and the execution risk. The discussions in [25] state the fact that the sign of ρ depends on the order type adopted by the trader due to adverse selection: when the trader uses market orders, the correlation ρ is negative while ρ is positive whenever trading with limit orders. In this paper, we regard ρ as a market parameter reflecting whether the market is trader-friendly or not.</li>
<li>-When ρ ≥ 0 , the stock price and execution risk tend to increase or decrease together: when the stock price increases, execution risk makes traders buy more or sell less than the amount they submit, which is benefit to the traders; when the stock price decreases, execution risk forces traders to buy less or sell more, which is also benefit to the traders. In such trader-friendly market, like the figure (1a), the broker should keep away from the reference strategy R t because an overly conservative strategy is not necessary.</li>
<li>-On the contrary, ρ &lt; 0 implies a trader-harmful market: when the stock price increases, execution risk makes traders buy less or sell more than the amount they submit, which is harm to the traders; when the stock price decreases, execution risk forces traders to buy more or sell less, which is also harm to the traders. In such trader-harmful market, like the figure (1b), the broker should keep close to the reference strategy R t to attain lower risk.</li>
</ul>
<figure><figcaption><div class="caption">Figure 1: Market parameter ρ</div></figcaption><img src="artifacts/image_000000_d741fe3abc50ba8b101f99984b7f56633e5cd054dd136ca3c292cb28539656a0.png"></figure>
<p>Remark 2. By applying the optimal strategy (5), one obtains the optimal liquidation trajectory x ∗ t as follows. For simplicity, take the parameters A = ρ = 0 , R t ≡ 0 and µ = 0 , x ∗ t satisfies the SDE</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>as β → + ∞ , x ∗ t has the limit</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, when m 0 → 0 , H → θη , the limit of the expression above is</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where κ = √ θσ 2 2 η . It recovers the classical implementation shortfall (IS) strategy (see in section 4.2), which implies the fact that our strategy can be regarded as a version of adaptive IS strategy. Furthermore, we may find that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which is an Ornstein-Uhlenbeck bridge [26]. Therefore, when m 0 is small, one may find an approximation to the optimal strategy</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which is a classical IS strategy plus an Ornstein-Uhlenbeck bridge, which reduces the strategy's inventory risk. Figure (2) shows the inventory risk of the optimal strategy and the classical IS strategy, which shows the fact that our optimal strategy has lower inventory risk than the classical IS strategy, especially at the end of the trading process.</p>
<figure><figcaption><div class="caption">Figure 2: Inventory risk of the optimal strategy and the classical IS strategy</div></figcaption><img src="artifacts/image_000001_af20e34e77e45e19240dc271a5c58471da60864335ff34830d4e09dd7cb274eb.png"></figure>
<p>To summary the section, it should be emphasized that despite the optimal feedback control behaves linearly in the states carries a certain meaning which we discuss in Remark 1, however, the case which we care most is where the execution risk does not exist, which is a limit case of Theorem 1, discussed in the next section.</p>
<h2>4 Zero execution risk</h2>
<p>For the purpose of better understanding as well as visualizing the optimal strategy obtained in (5), we present in this section the trading trajectory x t under optimal strategy in the case when m 0 = 0 for various reference strategies. In Section 4.1, we give the optimal strategy for general reference strategies. In Section 4.2, we present two classic trading strategies: IS order and TC order, both widely used in the market, and show that</p>
<p>they are special cases of our model. Next, we consider the case when the reference strategy is an endpointsonly one in Section 4.3, of which the optimal strategy has a heuristic form. Last but not least, piece-wise constant reference strategies are studied in Section 4.4.</p>
<p>Notice that in this case the setting of the problem reduces to that of the Almgren-Chriss but subject to a reference strategy. Furthermore, we shall set the final penalty parameter β → + ∞ , indicating that a final block trade at terminal time T is strictly prohibited.</p>
<h2>4.1 General reference strategy</h2>
<p>For a given generic reference strategy R t , the following theorem shows a representation for the trading trajectory x t under optimal control v ∗ .</p>
<p>Theorem 2. Let m ( v ) ≡ 0 and β → + ∞ . The trajectory x t under the solution to the optimization problem (2) is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>with the tuning parameter κ := √ θσ 2 2 η .</p>
<p>A few remarks on the trajectory x t shown in Theorem 2 are in order.</p>
<p>Remark 3. The parameter κ can be regarded as a tuning parameter between the TWAP and the reference strategies if µ = 0 . Specifically, in the limit as κ approaches zero, the optimal strategy converges to the TWAP strategy, i.e., for any t ∈ [0 , T ] , we have</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>On the other extreme as κ →∞ , the optimal trajectory converges to the reference strategy R t itself</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>for any t ∈ [0 , T ] .</p>
<p>Remark 4. The optimal trajectory may also be written as an 'affine transformation' as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>A more detailed discussion on this affine transformation can be found in Section 4.4.</p>
<p>where</p>
<p>Next, we further specialize the reference strategies and present their corresponding trajectories in the following sections.</p>
<h2>4.2 Implementation shortfall (IS) order and target close (TC) order</h2>
<p>Assume µ = 0 and the broker is asked to take as the reference strategy a block trade of size | A -x 0 | at t = 0 , i.e.,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The corresponding marked-to-market P&amp;L of the reference strategy R IS is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which is equivalent to choosing the initial price S 0 as reference price. This model is referred to as an implementation shortfall model in [27], of which the optimal strategy is</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>We shall refer to the strategy IS t as the unit implementation shortfall (IS) order . Hence, the trajectory in (6) can be interpreted as executing x 0 -A unit IS orders if a broker is missioned to make transition of his position from x 0 to A shares. We remark that, as we will show in Section 4.4, the unit IS orders are used as one of the building blocks for the construction of optimal trajectories for more general reference strategies.</p>
<figure><figcaption><div class="caption">Figure 3: Basic strategies in varying parameter κ .</div></figcaption><img src="artifacts/image_000002_7da6ca0cb5e10af52b1b69dcb86f909e32bf46c5af8ed58cc4da9f6bdd63353b.png"></figure>
<p>Figure (3a) shows examples of the unit implementation shortfall orders under various values of κ . Notice that, since κ = √ θσ 2 2 η , as θ, σ increase or η decreases, thus κ increases, the trajectories suggest the broker where</p>
<p>trade faster at the beginning and more slowly for the rest of the reallocation process. Indeed, the larger the κ , the faster the trading at the beginning. The financial rationale is as follows. Recall that θ is the coefficient of relative risk aversion for the utility function and σ is the volatility of stock price. Hence, if either of the parameters increases, the broker is more concerned with the price risk than the execution risk, he tends toward trading faster at the beginning and more slowly thereafter. Also, since η is the coefficient of slippage, as it decreases, the slippage decreases as well, resulting in lower cost from faster transactions. Therefore, again to mitigate the concern of price risk during reallocation process, the broker should also trade faster at the beginning as well.</p>
<p>Finally, we remark that, as κ → 0 , the unit IS order (7) converges to the TWAP (Time-Weight-AveragePrice) strategy: for any t ∈ [0 , T ] ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>On the flip side, as κ → + ∞ , the optimal trajectory (7) converges to a block trade at time 0 :</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Assume again that µ = 0 . Here the broker is given as the reference strategy to take only a block trade of size | A -x 0 | at terminal time T . That is,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The marked-to-market P&amp;L Π TC for this reference strategy is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which is equivalent to choosing the stock price S T at terminal time as the reference price. This model is referred to as an target close model [27][3], of which the optimal strategy is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>We refer to the strategy TC t in (9) as the unit target close (TC) order . Thus, similar to the case of implementation shortfall order in Section 4.2, the trajectory in (8) can be interpreted as executing x 0 -A unit TC orders if a broker is missioned to make transition of his position from x 0 to A shares. Likewise as for the unit IS orders, we show in Section 4.4 that the unit TC orders are used as the other building blocks for the where</p>
<p>construction of optimal trajectories for more general reference strategies.</p>
<p>Figure (3b) shows examples of plots for unit target close orders in different values of κ . We observe that the trading trajectories are concave in time as opposed to convex in time as that of the unit IS orders. Also, as κ increases, the optimal trajectory moves towards the reference strategy and towards the TWAP trajectory as κ decreases. In fact, similar to the case for implementation shortfall, in the limit as κ → 0 , the unit TC order (9) converges to the TWAP strategy: for any t ∈ [0 , T ] ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>whereas in the other extreme as κ → + ∞ , the optimal trajectory converges to a block trade at terminal time T :</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>4.3 Endpoints-only reference strategy</h2>
<p>In this section, we consider the following reference strategy R t , which we called the endpoints-only .</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The strategy is simply to hold R shares during the entire reallocation process, except at the initial and terminal times,.</p>
<p>The following lemma will prove itself useful in the determination of the optimal strategy subject to the reference strategy (10).</p>
<h2>Lemma 1. We have that</h2>
<div class="formula-not-decoded">Formula not decoded</div>
<p>In other words, the given integral can be written as the difference between a unit TC and a unit IS order.</p>
<p>We summarize the result for optimal strategies subject to (10) in the proposition that follows.</p>
<p>Proposition 2. With the reference strategy given in (10), the optimal trajectory is given by an affine combination of a unit IS order and a unit TC order as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Note that when µ = 0 and R = x 0 , the optimal strategy reduces to the following TC strategy as in (8)</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>whereas when µ = 0 and R = A , the optimal strategy reduces to the following IS strategy as in (6)</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Note that for any given reference level R , the optimal trajectory in (11) at any point in time is an affine combination of a unit IS order and a unit TC order. The coefficients represent a trade-off between the two strategies. For example, if R is closer to the initial position x 0 and further away from the target position A , the strategy in (11) suggests we weigh in more on the unit TC order and less on the unit IS order; conversely, one should then weigh in more on the unit IS order. Figure (4) shows the plots of optimal trajectories in different reference levels R , assuming x 0 = 1 and A = 0 . Again, we end up with a unit TC order when R = x 0 and a unit IS order when R = A .</p>
<figure><figcaption><div class="caption">Figure 4: Optimal strategies in different reference levels R .</div></figcaption><img src="artifacts/image_000003_185ec9d774fa5d922bc1f5d2c46e0de7943f7be59768355bc5fb0df5e1741cef.png"></figure>
<p>As shown in Figure 4, when R &gt; x 0 = 1 the optimal strategy suggest overshoot the target, meaning buying more than needed then sell back later and quicker when time approaches the terminal time. On the other hand, if R &lt; A = 0 , the optimal strategy suggests undershoots the target. We provide conditions on the parameters under which an overshooting or an undershooting occur in the following proposition.</p>
<p>Proposition 3. Without loss of generality, assume x 0 &gt; A . Let x t be the optimal strategy given in (11) . We have that, if R + µ θσ 2 &gt; x 0 , then x t is concave in t and it becomes convex in t if R + µ θσ 2 &lt; A . It follows that x t overshoots if and only if</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>and it undershoots if and only if</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>It appears that, when µ is nonzero, the terms in the optimal trajectory (11) that have µ involved always come in the form of µ θσ 2 . We provide a financial rationale of this combination of parameters as follows. Note that the combination resembles the Merton ratio in Merton's optimal portfolio problem in the market consisting of two assets: one risky and the other risk-less. The agent is risk averse with power utility u ( x ) = x γ and the dynamic of risky asset is governed by a geometric Brownian motion with expected return µ and volatility σ . The risk-less asset is assumed accruing zero interest. In this setting, the Merton ratio, which represents the percentage of wealth invested in the risky asset, is given by µ (1 -γ ) σ 2 . In our setting, the broker is with exponential utility u ( x ) = 1 θ (1 -e -θx ) and the stock price S t is assumed following an arithmetic Brownian motion with drift µ and volatility σ , i.e.,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>As in the derivation of the Merton ratio in Merton's problem, one may show that the 'Merton ratio' [28] in this case is given by µ θσ 2 except that this ratio does not represent the percentage of wealth invested in the risky asset as in the original Merton's problem. Indeed, this ratio represents the number of shares to be held in the optimal portfolio.</p>
<h2>4.4 Piece-wise constant reference strategy</h2>
<p>We consider in this section the reference strategies that are piece-wise constant across time. The consideration is that, to possibly account for real time market environments during the entire reallocation process, the broker's strategies may be subject to interval TWAP or VWAP strategies. For example, in an intraday trading activity, it is documented that the market trades much more actively at the times close to opening and closing than that in the middle of common trading days. Also, in the case where trading horizon across multiple days, the broker is most likely treating each trading day individually. In these regards, a piece-wise constant reference strategy is considered plausible.</p>
<p>Theoretically, as will be demonstrated, optimal trajectories subject to piece-wise constant reference strategies exhibit an elegant algebraic structure, derived from the unit IS and unit TC orders discussed in Sections 4.2. By applying standard approximation and limiting processes for integrable functions, this structure offers practical and insightful guidance for developing optimal strategies under general integrable reference strategies. Concretely, a generic piece-wise constant reference strategy R t is defined as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where 1 {·} denotes the indicator function, n is the number of periods, and the R ( k ) 's are fixed constants. The following proposition summarizes the optimal trajectory under the piece-wise constant reference strategy in (12).</p>
<p>Proposition 4. When µ = m 0 = 0 , β → + ∞ , denote R (0) := x 0 and R ( n +1) := A , the solution to the previous optimization problem under the piece-wise constant reference strategy given in (12) is of the following form, for 1 ≤ k ≤ n ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>and a k is denoted as a weighted average of R ( i ) 's:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Notice that the IS t and TC t in Proposition 4 are indeed respectively the unit IS order given in (7) and the unit TC order in (9). Proposition 4 essentially states that, for a given piece-wise constant reference strategy, its corresponding optimal solution in each sub-interval is given by an affine transformation of a unit IS order and a unit TC order. In this sense we may regard the unit IS orders and the unit TC orders obtained in Sections 4.2 as the building blocks or bases for optimal trajectories under piece-wise constant reference strategies. The algebraic structure of the optimal trajectories is thus depicted by the affine space generated by the unit IS and unit TC orders. What are left to be determined are the coefficients that are sub-interval dependent. In practice, one should firstly calculate a k 's by linear combinations of R ( i ) 's, then optimal strategy is obtained by connecting a k 's using unit IS and unit TC orders. As an example, Figure (5) shows the plots of a piece-wise constant reference strategy (in dotted red) its optimal trajectory (in blue) with three sub-intervals n = 3 , the other parameters are given by T = 3 , κ = 5 , R (1) = 15 2 , R (2) = 9 2 , R (3) = 3 2 , x 0 = 9 , A = 0 . To conclude the</p>
<figure><figcaption><div class="caption">Figure 5: A three-period piece-wise constant reference strategy and its corresponding optimal trajectory.</div></figcaption><img src="artifacts/image_000004_d89ddef110f1480b5768203c4024ce99bcda21795cea21a4dd5226436eb40fcd.png"></figure>
<p>section, we show in Theorem 3 a stability theorem for optimal strategies subject to general, smooth enough, reference strategies.</p>
<p>Theorem 3. For any given reference strategies R t and ˜ R t satisfying</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>for some ε &gt; 0 . Let x t and ˜ x t be the corresponding optimal trajectories for R t and ˜ R t , respectively. We have that, for any 0 ≤ t ≤ T ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>The above theorem basically states the fact that when two reference strategies are close in the L 2 sense, their corresponding optimal strategies remain close in the sup norm sense. Note that for any ε &gt; 0 and an almost everywhere continuous bounded RS R t , there exists a piece-wise constant RS ˜ R t such that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>It follows that the optimal trajectory in (13) for ˜ R t , which is an affine transformation of unit IS and unit TC orders in each sub-interval, can be applied as an approximation to the optimal trajectory under reference strategy R t , with error estimate given in Theorem 3.</p>
<h2>5 Numerical examples</h2>
<p>We conduct in this section numerical experiments on the implementation of optimal strategy obtained in Theorem 1 and stress testing the strategy against various parameters. Monte Carlo simulations are implemented to illustrate sample trading trajectories and the performances criteria of the optimal strategy versus those of a related TWAP strategy. The performance of the optimal and TWAP strategies are then stress tested against certain extreme parameters. We remark that the parameters chosen for the numerical examples in this section are for convenience only. In practice, parameters are supposedly calibrated to market data prior to implementation, causing possible issues associated with estimation risk.</p>
<h2>5.1 Sample trading trajectories</h2>
<p>We present in Figures (6) through (11) sample trading trajectories under the optimal and a related TWAP strategies in various parameters. Parameters chosen as base case are ( m 0 , η, ρ, θ, σ, β ) = (0 . 05 , 10 , 0 , 0 . 002 , 200 , 1000) . Table 1 summarizes the parameters that vary, while the others are held fixed, in each case and their corresponding figures. The reference strategy R t is selected as a block trade at t = 0 , as shown in Section 4.2.</p>
<p>Figure (6) illustrates sample trading trajectories for the optimal and the TWAP strategies in different values of m 0 . We note that, since m 0 quantifies the execution risk, as m 0 increases both trajectories become more volatile and fluctuating.</p>
<table><caption><div class="caption">Table 1: Sample trading trajectory in varying parameters</div></caption><tbody><tr><th>Figure number</th><th>Parameter</th><th>Case 1</th><th>Case 2</th><th>Case 3</th></tr><tr><th>Figure 6</th><td>m 0</td><td>0.00</td><td>0.05</td><td>0.10</td></tr><tr><th>Figure 7</th><td>η</td><td>5</td><td>10</td><td>20</td></tr><tr><th>Figure 8</th><td>ρ</td><td>-0.9</td><td>0</td><td>0.9</td></tr><tr><th>Figure 9</th><td>θ</td><td>0.001</td><td>0.002</td><td>0.004</td></tr><tr><th>Figure 10</th><td>σ</td><td>100</td><td>200</td><td>400</td></tr><tr><th>Figure 11</th><td>β</td><td>100</td><td>1000</td><td>10000</td></tr></tbody></table>
<figure><figcaption><div class="caption">Figure 6: Sample trading trajectories in different m 0</div></figcaption><img src="artifacts/image_000005_f2bb3fbffbd97b24220e90a4f0ce0248dafab2b26107e68c43a588de6a4b797c.png"></figure>
<p>Figure (7) exhibits sample trading trajectories in varying values of η . It is worth mentioning that, since η reflects the level of transaction costs, as the value of η increases, transaction cost becomes more significant in the determination of optimal strategies. Consequently, the optimal strategy tends to align more closely with the classical TWAP strategy. In other words, a higher η places greater emphasis on minimizing transaction costs, motivating the adoption of a strategy that mirrors the TWAP approach, which aims for consistent execution over time.</p>
<p>Figure (8) shows optimal strategies in the values of ρ = -0 . 5 , 0 , 0 . 5 . Recall that ρ denotes the correlation between the stock price and the execution risk. We note that there seems no significant dependence of the optimal strategies on ρ within this set of parameters.</p>
<figure><figcaption><div class="caption">Figure 7: Sample trading trajectories in different η</div></figcaption><img src="artifacts/image_000006_5e0e1c6189245346e2601afb17e1e5b0e5251b4101a8ab4de43575a3b6378bfd.png"></figure>
<figure><figcaption><div class="caption">Figure 8: Sample trading trajectories in different ρ</div></figcaption><img src="artifacts/image_000007_3caddd071accdceffb7079ad026d836ccd19917c07cce1469997b47c50e16a8d.png"></figure>
<p>Figure (9) illustrates the optimal strategies in the values of θ = 0 . 001 , 0 . 002 , 0 . 004 , which represents the broker's taste of risk aversion. The larger the value of θ , the more risk averse the broker tends to be. It follows that the sample trading trajectory under optimal strategy gradually converges towards the reference strategy as θ increases, indicating the broker's inclination to adopt a more conservative and risk-averse approach.</p>
<figure><figcaption><div class="caption">Figure 9: Sample trading trajectories in different θ</div></figcaption><img src="artifacts/image_000008_1aa5cf6acf7099e006dfbeb30e0195a944b77cd61506eac25974cbb66b7915cf.png"></figure>
<p>Figure (10) shows sample trading trajectories under optimal strategies with respect to the stock volatility σ = 100 , 200 , 400 . As σ increases, the price risk increases. Thus, to mitigate the risk incurred from the price volatility during execution, the optimal strategy tracks more closely to the reference strategy.</p>
<figure><figcaption><div class="caption">Figure 10: Sample trading trajectories in different σ</div></figcaption><img src="artifacts/image_000009_55bd8a0bb0447784abf51d79d7285cf55daf8e9e7de363981d75524be69e04b8.png"></figure>
<p>Figure (11) presents the optimal strategies in the values of β = 100 , 1000 , 10000 , which quantifies the penalty of block trade at terminal time. Large β indicates that any remaining inventory at terminal time is unfavorable. Therefore, it is seen in the figure that the terminal inventory x ∗ T of the sample trading trajectories under optimal strategy gradually approaches zero. It is thus fathomable that, as β approaches infinity, a final block trade at terminal time turns into strictly prohibited.</p>
<figure><figcaption><div class="caption">Figure 11: Sample trading trajectories in different β</div></figcaption><img src="artifacts/image_000010_626cf181b3415010ba39fe8053e261b19c5c443b53f3578f73f1ca265279a7f0.png"></figure>
<h2>5.2 Performance analysis and stress test</h2>
<p>To demonstrate the performance of the optimal strategy against TWAP, we implement the strategies using Monte Carlo simulations and present the resulting histograms and boxplots of the terminal wealths as well as the utilities at the investment horizon. This performance analysis serves to illustrate the optimality and robustness of the optimal strategy.</p>
<figure><figcaption><div class="caption">Figure 12: Histograms and boxplots of terminal wealths and utilities under the optimal and the TWAP strategies. Terminal wealth on the left, utility on the right. Vertical dashed lines indicate sample means.</div></figcaption><img src="artifacts/image_000011_c7ea17caff469101fb9793bbe94fe6d1425238672bcc21a9473e7a91df615d59.png"></figure>
<p>Figure (12) exhibits the histograms and boxplots of the terminal P&amp;L (on the left) and the utility (on the left) at investment horizon for the optimal and the TWAP strategies. We observe that the optimal</p>
<table><caption><div class="caption">Table 2: Stress testing parameters</div></caption><tbody><tr><td></td><th>m 0</th><th>η</th><th>ρ</th><th>θ</th><th>σ</th><th>β</th></tr><tr><th>Baseline</th><td>0.05</td><td>10</td><td>0</td><td>0.002</td><td>200</td><td>1e6</td></tr><tr><th>Scenario 1 (large σ )</th><td>0.05</td><td>10</td><td>0</td><td>0.002</td><td>2000</td><td>1e6</td></tr><tr><th>Scenario 2 (large β )</th><td>0.05</td><td>10</td><td>0</td><td>0.002</td><td>200</td><td>1e7</td></tr><tr><th>Scenario 3 (large m 0 )</th><td>5</td><td>10</td><td>0</td><td>0.002</td><td>200</td><td>1e6</td></tr><tr><th>Scenario 4 (small η )</th><td>0.05</td><td>0.1</td><td>0</td><td>0.002</td><td>200</td><td>1e6</td></tr></tbody></table>
<p>strategy not only consistently achieves higher average terminal wealth and utility than those under TWAP but also bears lower variability. Furthermore, an intriguing observation is made regarding the tail ends of the distribution. Specifically, the TWAP strategy demonstrates a greater density in these tail regions, indicating a higher likelihood of incurring significant losses when compared to our optimal strategy. This discrepancy in density at the tail end reinforces the notion that the TWAP strategy may accentuate the potential for unfavorable outcomes, thus reflecting a subpar approach to risk management.</p>
<p>Finally, we stress test the optimal and the TWAP strategies against extreme parameters. While the remaining parameters are held the same as in the benchmark case, the stock volatility σ is scaled up by ten folds in Scenario 1, the terminal penalty coefficient β up by ten folds in Scenario 2, the execution risk m 0 up by a hundred folds in Scenario 3, and lastly in Scenario 4 down by 0.1 hundred folds the temporary cost η . Table 2 summarizes the parameters that are stress tested in each scenario and Figure 13 shows the histograms and boxplots of P&amp;Ls at the terminal time under the optimal and the TWAP strategies.</p>
<p>Apparently, in all the scenarios the histograms under optimal strategies are concentrated around zero whereas those under TWAP strategies are much more widely spreading. Also, the sample means under optimal strategies are higher than those of TWAP strategies. We conclude that, even under extreme situations, the optimal strategies outperform TWAP strategies not only in higher averaged P&amp;L but also with lower volatility risk, which shows the robustness of our results.</p>
<figure><figcaption><div class="caption">Figure 13: Histograms and boxplots of terminal P&amp;L under stress tests. Scenarios 1 on the top left, 2 on the top right, 3 on the bottom left, and 4 on the bottom right. Vertical dashed lines indicate sample means.</div></figcaption><img src="artifacts/image_000012_64e42194784f001cc9adab5d7d23ddd52a8db39085e99c1ac93a328e68454be8.png"></figure>
<h2>6 Conclusion</h2>
<p>In this article, we showed how the broker's order execution problem under execution risk subject to client's reference strategy can be recast as a utility maximization problem. The optimal solution to the utility maximization problem was obtained by solving an associated Riccati differential equation and was presented in feedback form. When execution risk vanishes, the optimal strategies become deterministic and were given in closed form. We showed that trading trajectories subject to the unit IS and the unit TC orders form a basis of an affine structure for trading trajectories under optimal strategies subject to general piece-wise constant reference strategies. As for general continuous reference strategies, we proved an approximation and stability theorem for the trading trajectory under the corresponding optimal strategy via the trajectories from piece-wise constant reference strategies.</p>
<p>Numerical experiments showed that the optimal strategies not only achieve higher expected values but also bear lower variabilities as opposed to those under TWAP strategies. Numerical performance analysis and stress tests confirmed that optimal strategies outperform TWAP strategies, by a wide margin in certain cases. Possible extensions of the framework considered in the paper include (a) a stochastic component to the price evolution reflecting the overall market activity such macroeconomics factors or news; (b) the price impact, rather than permanent, being transient with proper decay kernel. We leave these considerations to a future study.</p>
<h2>Acknowledgement</h2>
<p>This research is supported by the National Natural Science Foundation of China (Grants No.11971040).</p>
<h2>A Appendix</h2>
<h2>A.1 Proof to Proposition 1</h2>
<p>By Itô's formula,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, note that ˜ S t = S t + ηv t ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>in summary,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.2 Risk-Neutral Case of Theorem 1</h2>
<p>In Section (3) we recast the optimal execution problem as a utility maximization problem with the CARA preference u ( x ) = 1 θ (1 -e -θx ) with parameter θ &gt; 0 , which reflects the broker's risk aversion. As θ → 0 , the utility function u ( x ) = lim θ → 0 1 θ (1 -e -θx ) = x describes a risk-neutral preference. With the admissible set A and the excess P&amp;L ˜ Π given in Section (2.2) and Section (3), the risk-neutral expected utility is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>When the execution risk is constant (i.e. m ( · ) ≡ m 0 for some m 0 ≥ 0 ), the utility maximization problem reduces to the following Stochastic Linear Quadratic (SLQ) control problem [22]:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Define the value function V ( t, x ) as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where A t := { v is progressively measurable in [ t, T ] and ∫ T t E [ v 2 s ]d s &lt; ∞ } . Note that our problem satisfies assumption (L1) given in Section 3.1 of [22] due to the boundedness of the coefficients, so the problem is solvable, and by the dynamic programming principle, the value function V is unique satisfying the HamiltonJacobi-Bellman (HJB hereafter) equation</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>□</p>
<p>with terminal condition v ( T, x ) = -β ( x -A ) 2 . With first order criterion, the optimal feedback control is given by v ∗ = -1 2 η ( γ ( x -A ) + V x ) , hence the HJB equation reduces to</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Assume the Ansarz for value function V</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Plug the Ansarz into the HJB equation yields the Riccati ODE system</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>By solving the ODE system, the deterministic functions a, b, c of time t are given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where α := 2 η 2 β -γ &gt; 0 . Note that V ( t, x ) = a ( t ) x 2 + b ( t ) x + c ( t ) is continuous on [0 , T ] × R and continuously differentiable on (0 , T ) × R satisfying the HJB equation, therefore it must be the value function by the uniqueness of solutions to the HJB equation. Then the verification theorem gives rise to the optimal feedback control</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Due to the boundedness of 1 T -t + α and -A T -t + α -µ 4 η ( ( T -t + α ) -α 2 T -t + α ) , v ∗∗ ∈ A , which implies that the optimal control v ∗∗ lies in the admissible set. Moreover, the maximal risk-neutral expected utility is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.3 Proof to Theorem 1</h2>
<p>Note that x t = x 0 -∫ t 0 v s d s + m 0 d Z t , by Itô's formula,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, note that standard Brownian motions W t and Z t have constant correlation ρ , denote standard Brownian motion W 1 t = Z t -ρW t √ 1 -ρ 2 , then W 1 t and W t are independent. By extracting the constants and deterministic parts out of the expectation, the value function is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where we observe the equivalent optimization problem</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Our stochastic control problem has a similar form as stochastic linear exponential quadratic (SLEQ) control problems given in [23] and [24], however, due to the constants and stochastic integrals appearing in our exponential function, these existing results can't be used directly. Instead, we follow the 'completing the square' technique used in [23], which is used to transform the integrand into a square form by introducing a Radon-Nikodym derivative. In this paper, we eliminate the stochastic integrals and 'complete the square' simultaneously by Girsanov's theorem. More precisely, we manage to find some probability measure Q ≪ P such that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where 1 L ( t,T ) · exp { J ( t, T ) } can be transformed into a square form without Itô integrals. Concretely, suppose the Radon-Nikodym derivative is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where Ψ 1 and Ψ 2 are L 2 -functions to be determined. At the same time, for some deterministic function G 1 ( t ) and G 2 ( t ) such that G 1 ( T ) = G 2 ( T ) = 0 , by Ito's lemma,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Hence,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>By setting</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>the stochastic integrals ∫ T t · · · d W s and ∫ T t · · · d W 1 s appear to be zero. Moreover,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where the coefficients are given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>To make sure the integrand in (14) behaves as a square form (plus constants), we rewrite it as a quadratic function of v s :</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>of which the discriminant is set to be zero:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>hence,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Denote b 2 ( s ) := G 1 ( s ) + θ 2 (2 β -γ ) and b 1 ( s ) := 2 G 2 ( s ) , we may solve the ODEs b 2 ( · ) and b 1 ( · ) satisfy:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where l 3 = 1 2 m 0 ηθ 2 ρσ and l 1 = θ 2 σ 2 2 H . We may solve that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where</p>
<p>Moreover, we have b 1 solves the ODE</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>With b 1 and b 2 solved, we may rewrite the integrand in (14) as</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where</p>
<p>Denote we have</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where the equation holds when v s = v ∗ s := g 1 ( s )( x s -A ) + g 0 ( s ) . Note that g 1 and g 0 are bounded and continuous on [0 , T ] , so v ∗ ∈ A t , hence,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, the value function is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>In summary, the optimal feedback control is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.4 Proof to Theorem 2</h2>
<p>When m ( v ) = m 0 = 0 and β = 0 , d x t = -v t d t , according to Theorem 1, H = θη , l 3 = 0 , l 1 = θ 3 σ 2 η 2 , A 0 = 0 , and</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, b 1 solves the backward ODE</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Note that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Integrate on both sides,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Note that now hence,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Integrate on both sides then integrate by parts, we have</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Denote we can solve that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.5 Proof to Lemma 1</h2>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.6 Proof to Proposition 2</h2>
<p>By Theorem 2 and Lemma 1,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>A.7 Proof to Proposition 3</h2>
<p>Note that R + µ θσ 2 appears as a whole, so WLOG, we may assume that µ ≡ 0 . When the reference strategy is R , the optimal strategy is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>note that 0 ≤ t ≤ T , then cosh κt ≥ 0 and cosh κ ( T -t ) ≥ 0 , so when A ≤ R ≤ x 0 , v t ≥ 0 , which represents that the optimal strategy does not contain overshooting. Note that</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>so when R &gt; x 0 &gt; A , x ′′ t = -v ′ t ≤ 0 , which implies that the optimal strategy is a concave function, so</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>then</p>
<p>□</p>
<p>□</p>
<p>□</p>
<p>so when so when</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>the optimal strategy contains overshooting, and when x 0 &lt; R ≤ x 0 + 1 cosh κT -1 · ( x 0 -A ) , the optimal strategy does not contains overshooting. Similarly, when R &lt; A &lt; x 0 , q ′′ t = -v ′ t ≥ 0 , which implies that the optimal strategy is a convex function, so</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>the optimal strategy contains overshooting.</p>
<h2>A.8 Proof to Proposition 4</h2>
<p>By the results given in Theorem 2, the optimal strategy is a deterministic one. In other words, when µ = m 0 = 0 ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where A det = { v ∈ A : v is deterministic } . When v ∈ A det , x t = x 0 -∫ t 0 v s d s is also deterministic, hence,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Subject to x T = A (or β → + ∞ ) , ∫ T 0 v t ( x t -A )d t = 1 2 ( x 0 -A ) 2 is a constant, hence, maximizing the expected utility is equivalent to a typical variational problem</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Note that the objective can be divided into n parts, each with a constant RS:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>We divide the optimization problem into three steps:</p>
<ul>
<li style="list-style-type: '· ';">Find the optimal value of x ∗ kT n , 1 ≤ k ≤ n -1 . We can directly use Theorem 2: suppose the optimal</li>
</ul>
<p>□</p>
<p>strategy is x ∗ t , note that µ = 0 ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where R is the given piece-wise constant RS. For 1 ≤ k ≤ n -1 ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Denote R (0) := x 0 , R ( n +1) := A , and</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>we can rewrite</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Furthermore, we denote the optimal values a k := x ∗ kT n , 1 ≤ k ≤ n -1 . Note that the sum of coefficients in a k is</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>so a k is a weighted average of R ( i ) 's.</p>
<ul>
<li style="list-style-type: '· ';">Note that we already know the value of optimal strategy x kT n , so the optimization problem is equivalent to the following optimization problem with extra constraints:</li>
</ul>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Denote a 0 = x 0 and a n = A , inheriting from the spirit of dynamic programming, we can further divide the optimization problem into n parts: for 1 ≤ k ≤ n , where the k -th sub-problem is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which is a constant RS problem with time period [ ( k -1) T n , kT n ] , of which the optimal strategy is given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where κ := √ θσ 2 2 η and</p>
<div class="formula-not-decoded">Formula not decoded</div>
<ul>
<li style="list-style-type: '· ';">Connect n optimal strategies to obtain the optimal strategy of the original optimization problem. Denote</li>
</ul>
<div class="formula-not-decoded">Formula not decoded</div>
<p>then by the results of constant reference strategies, for any strategy x t ,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where implies that the optimal value is obtained when x t = x ∗∗ t , in other words, x ∗∗ t is the optimal strategy.</p>
<p>□</p>
<h2>A.9 Proof to Theorem 3</h2>
<p>According to Theorem 2, the optimal strategies x t and ˜ x t can be given by</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>and</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where x t , ˜ x t are the optimal strategy with respect to reference strategies R t and ˜ R t respectively. Hence, by Jensen's inequality,</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>which implies the fact that when ε → 0 , ˜ x t → x t . So we may use the optimal strategy by a piece-wise constant RS to approximate the general RS, with small error</p>
<div class="formula-not-decoded">Formula not decoded</div>
<h2>References</h2>
<ol>
<li style="list-style-type: '[1] ';">R. Almgren and N. Chriss, 'Optimal execution of portfolio transactions,' Journal of Risk , vol. 3, pp. 5-40, 2001.</li>
<li style="list-style-type: '[2] ';">C. Institute, CFA Program Curriculum 2018 Level II . John Wiley &amp; Sons, 2017.</li>
<li style="list-style-type: '[3] ';">O. Guéant, 'Target close execution strategies.' [Online]. Available: https://www.oliviergueant.com/ uploads/4/3/0/9/4309511/targetclose.pdf</li>
<li style="list-style-type: '[4] ';">R. Almgren and N. Chriss, 'Value under liquidation,' Risk , vol. 12, no. 12, pp. 61-63, 1999.</li>
<li style="list-style-type: '[5] ';">R. F. Almgren, 'Optimal execution with nonlinear impact functions and trading-enhanced risk,' Applied Mathematical Finance , vol. 10, no. 1, pp. 1-18, 2003.</li>
<li style="list-style-type: '[6] ';">D. Bertsimas and A. W. Lo, 'Optimal control of execution costs,' Journal of Financial Markets , vol. 1, no. 1, pp. 1-50, 1998.</li>
<li style="list-style-type: '[7] ';">J. Gatheral, 'No-dynamic-arbitrage and market impact,' Quantitative finance , vol. 10, no. 7, pp. 749-759, 2010.</li>
<li style="list-style-type: '[8] ';">J. Gatheral, A. Schied, and A. Slynko, 'Transient linear price impact and fredholm integral equations,' Mathematical Finance: An International Journal of Mathematics, Statistics and Financial Economics , vol. 22, no. 3, pp. 445-474, 2012.</li>
<li style="list-style-type: '[9] ';">S. Tse, P. Forsyth, J. Kennedy, and H. Windcliff, 'Comparison between the mean-variance optimal and the mean-quadratic-variation optimal trading strategies,' Applied Mathematical Finance , vol. 20, no. 5, pp. 415-449, 2013.</li>
<li style="list-style-type: '[10] ';">X. Cheng, M. Di Giacinto, and T.-H. Wang, 'Optimal execution with dynamic risk adjustment,' Journal of the Operational Research Society , vol. 70, no. 10, pp. 1662-1677, 2019.</li>
<li style="list-style-type: '[11] ';">C. Frei and N. Westray, 'Optimal execution of a vwap order: a stochastic control approach,' Mathematical Finance , vol. 25, no. 3, pp. 612-639, 2015.</li>
<li style="list-style-type: '[12] ';">Á. Cartea and S. Jaimungal, 'A closed-form execution strategy to target volume weighted average price,' SIAM Journal on Financial Mathematics , vol. 7, no. 1, pp. 760-785, 2016.</li>
<li style="list-style-type: '[13] ';">O. Guéant and G. Royer, 'Vwap execution and guaranteed vwap,' SIAM Journal on Financial Mathematics , vol. 5, no. 1, pp. 445-471, 2014.</li>
<li style="list-style-type: '[14] ';">R. Almgren and J. Lorenz, 'Adaptive arrival price,' Trading , vol. 2007, no. 1, pp. 59-66, 2007.</li>
<li style="list-style-type: '[15] ';">C. Frei and N. Westray, 'Optimal execution in hong kong given a market-on-close benchmark,' Quantitative Finance , vol. 18, no. 4, pp. 655-671, 2018.</li>
<li style="list-style-type: '[16] ';">O. Guéant, J. Pu, and G. Royer, 'Accelerated share repurchase: pricing and execution strategy,' International Journal of Theoretical and Applied Finance , vol. 18, no. 03, p. 1550019, 2015.</li>
</ol>
<ol>
<li style="list-style-type: '[17] ';">L. Bargeron, M. Kulchania, and S. Thomas, 'Accelerated share repurchases,' Journal of Financial Economics , vol. 101, no. 1, pp. 69-89, 2011.</li>
<li style="list-style-type: '[18] ';">X. Cheng, M. Di Giacinto, and T.-H. Wang, 'Optimal execution with uncertain order fills in almgrenchriss framework,' Quantitative Finance , vol. 17, no. 1, pp. 55-69, 2017.</li>
<li style="list-style-type: '[19] ';">R. Carmona and L. Leal, 'Optimal execution with quadratic variation inventories,' SIAM Journal on Financial Mathematics , vol. 14, no. 3, pp. 751-776, 2023.</li>
<li style="list-style-type: '[20] ';">M. Nutz, K. Webster, and L. Zhao, 'Unwinding stochastic order flow: When to warehouse trades,' arXiv preprint arXiv:2310.14144 , 2023.</li>
<li style="list-style-type: '[21] ';">Á. Cartea and L. Sánchez-Betancourt, 'Brokers and informed traders: dealing with toxic flow and extracting trading signals,' Available at SSRN 4265814 , 2022.</li>
<li style="list-style-type: '[22] ';">J. Yong and X. Y. Zhou, Stochastic controls: Hamiltonian systems and HJB equations . Springer Science &amp; Business Media, 2012, vol. 43.</li>
<li style="list-style-type: '[23] ';">T. E. Duncan, 'Linear-exponential-quadratic gaussian control,' IEEE Transactions on Automatic Control , vol. 58, no. 11, pp. 2910-2911, 2013.</li>
<li style="list-style-type: '[24] ';">A. E. Lim and X. Y. Zhou, 'A new risk-sensitive maximum principle,' IEEE transactions on automatic control , vol. 50, no. 7, pp. 958-966, 2005.</li>
<li style="list-style-type: '[25] ';">R. Carmona and K. Webster, 'The self-financing equation in limit order book markets,' Finance and Stochastics , vol. 23, no. 3, pp. 729-759, Jul. 2019.</li>
<li style="list-style-type: '[26] ';">A. Mazzolo, 'Constraint Ornstein-Uhlenbeck bridges,' Journal of Mathematical Physics , vol. 58, no. 9, p. 093302, 09 2017.</li>
<li style="list-style-type: '[27] ';">O. Guéant, The Financial Mathematics of Market Liquidity: From optimal execution to market making . CRC Press, 2016, vol. 33.</li>
<li style="list-style-type: '[28] ';">R. C. Merton, 'Optimum consumption and portfolio rules in a continuous-time model,' in Stochastic optimization models in finance . Elsevier, 1975, pp. 621-661.</li>
</ol>
</div>
</body>
</html>